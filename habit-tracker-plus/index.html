<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ALIBI Pro - Habit Tracker AvancÃ©</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#6366f1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ¯</text></svg>">

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <!-- Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>

<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loader">
            <div class="loader-icon">ğŸ¯</div>
            <div class="loader-text">ALIBI Pro</div>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="app" class="app hidden">
        <!-- Header -->
        <header class="header">
            <div class="header-top">
                <div class="logo">ğŸ¯ ALIBI <span class="pro-badge">PRO</span></div>
                <div class="streak-badge" id="total-streak">
                    <span class="streak-icon">ğŸ”¥</span>
                    <span class="streak-count">0</span>
                </div>
            </div>
            <div class="header-info">
                <div class="greeting" id="greeting">Bonjour !</div>
                <div class="date-display" id="current-date"></div>
            </div>
        </header>

        <!-- Tab Content Container -->
        <main class="tab-content">
            <!-- Today Tab (Main Tracking View) -->
            <section id="tab-today" class="tab-panel active">
                <div class="today-progress">
                    <div class="progress-circle">
                        <svg viewBox="0 0 36 36" class="circular-chart">
                            <path class="circle-bg"
                                d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                            <path id="progress-circle-path" class="circle" stroke-dasharray="0, 100"
                                d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                        </svg>
                        <div class="progress-text">
                            <span id="progress-done">0</span>/<span id="progress-total">0</span>
                        </div>
                    </div>
                    <div class="progress-label">habitudes aujourd'hui</div>
                </div>

                <div id="today-habits" class="habits-by-category">
                    <!-- Generated by JS -->
                </div>

                <div id="empty-today" class="empty-state hidden">
                    <div class="empty-icon">ğŸ‰</div>
                    <p>Aucune habitude pour aujourd'hui</p>
                    <p class="empty-hint">Profite de ta journÃ©e ou ajoute une nouvelle habitude !</p>
                </div>
            </section>

            <!-- All Habits Tab -->
            <section id="tab-habits" class="tab-panel">
                <div class="section-header">
                    <h2>Toutes les habitudes</h2>
                    <span id="habits-count" class="badge">0</span>
                </div>

                <div class="filter-bar">
                    <button class="filter-btn active" data-filter="all">Toutes</button>
                    <button class="filter-btn" data-filter="spiritual">ğŸ™ Spirituel</button>
                    <button class="filter-btn" data-filter="health">ğŸ’ª SantÃ©</button>
                    <button class="filter-btn" data-filter="learning">ğŸ“š Apprentissage</button>
                    <button class="filter-btn" data-filter="chores">ğŸ§¹ TÃ¢ches</button>
                    <button class="filter-btn" data-filter="work">ğŸ’¼ Travail</button>
                    <button class="filter-btn" data-filter="projects">ğŸš€ Projets</button>
                    <button class="filter-btn" data-filter="leisure">ğŸ® Loisirs</button>
                </div>

                <div id="all-habits-list" class="habits-list">
                    <!-- Generated by JS -->
                </div>

                <div id="empty-habits" class="empty-state hidden">
                    <div class="empty-icon">ğŸ“‹</div>
                    <p>Aucune habitude crÃ©Ã©e</p>
                    <p class="empty-hint">Ajoute ta premiÃ¨re habitude avec le bouton +</p>
                </div>
            </section>

            <!-- Upcoming Tab -->
            <section id="tab-upcoming" class="tab-panel">
                <div class="section-header">
                    <h2>Prochaines tÃ¢ches</h2>
                </div>

                <div class="upcoming-section">
                    <h3>Aujourd'hui</h3>
                    <div id="upcoming-today-list" class="upcoming-list"></div>
                </div>

                <div class="upcoming-section">
                    <h3>Cette semaine</h3>
                    <div id="upcoming-week-list" class="upcoming-list"></div>
                </div>

                <div class="upcoming-section">
                    <h3>Plus tard</h3>
                    <div id="upcoming-later-list" class="upcoming-list"></div>
                </div>
            </section>

            <!-- Stats Tab -->
            <section id="tab-stats" class="tab-panel">
                <div class="section-header">
                    <h2>Statistiques</h2>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="stat-streak">0</div>
                        <div class="stat-label">Meilleur streak</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-total">0</div>
                        <div class="stat-label">Total complÃ©tÃ©es</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-rate">0%</div>
                        <div class="stat-label">Taux de rÃ©ussite</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-habits">0</div>
                        <div class="stat-label">Habitudes actives</div>
                    </div>
                </div>

                <div class="stats-section">
                    <h3>Cette semaine</h3>
                    <div class="week-grid" id="week-stats">
                        <!-- Generated by JS -->
                    </div>
                </div>

                <div class="stats-section">
                    <h3>Par catÃ©gorie</h3>
                    <div id="category-stats" class="category-stats">
                        <!-- Generated by JS -->
                    </div>
                </div>
            </section>

            <!-- Add Habit Tab -->
            <section id="tab-add" class="tab-panel">
                <div class="section-header">
                    <h2>Nouvelle habitude</h2>
                </div>

                <form id="add-habit-form" class="add-form">
                    <!-- Basic Info -->
                    <div class="form-group">
                        <label for="habit-name">Nom de l'habitude *</label>
                        <div class="input-with-emoji">
                            <input type="text" id="habit-name" placeholder="Ex: Lire 30 minutes" required>
                            <input type="text" id="habit-emoji" class="emoji-input" placeholder="ğŸ“š" maxlength="2">
                        </div>
                    </div>

                    <!-- Category -->
                    <div class="form-group">
                        <label for="habit-category">CatÃ©gorie</label>
                        <select id="habit-category">
                            <option value="learning">ğŸ“š Apprentissage</option>
                            <option value="spiritual">ğŸ™ Spirituel</option>
                            <option value="health">ğŸ’ª SantÃ©</option>
                            <option value="chores">ğŸ§¹ TÃ¢ches mÃ©nagÃ¨res</option>
                            <option value="work">ğŸ’¼ Travail</option>
                            <option value="projects">ğŸš€ Projets</option>
                            <option value="leisure">ğŸ® Loisirs</option>
                        </select>
                    </div>

                    <!-- Color -->
                    <div class="form-group">
                        <label>Couleur</label>
                        <div class="color-picker">
                            <button type="button" class="color-btn active" data-color="#6366f1"
                                style="background:#6366f1"></button>
                            <button type="button" class="color-btn" data-color="#a855f7"
                                style="background:#a855f7"></button>
                            <button type="button" class="color-btn" data-color="#ec4899"
                                style="background:#ec4899"></button>
                            <button type="button" class="color-btn" data-color="#f43f5e"
                                style="background:#f43f5e"></button>
                            <button type="button" class="color-btn" data-color="#f97316"
                                style="background:#f97316"></button>
                            <button type="button" class="color-btn" data-color="#eab308"
                                style="background:#eab308"></button>
                            <button type="button" class="color-btn" data-color="#22c55e"
                                style="background:#22c55e"></button>
                            <button type="button" class="color-btn" data-color="#14b8a6"
                                style="background:#14b8a6"></button>
                        </div>
                    </div>

                    <!-- Frequency -->
                    <div class="form-group">
                        <label for="habit-frequency">FrÃ©quence</label>
                        <select id="habit-frequency">
                            <option value="daily">Tous les jours</option>
                            <option value="times_per_week">X fois par semaine</option>
                            <option value="specific_days">Jours spÃ©cifiques</option>
                            <option value="every_x_days">Tous les X jours</option>
                            <option value="every_x_weeks">Toutes les X semaines</option>
                            <option value="monthly">Mensuel</option>
                            <option value="every_x_months">Tous les X mois</option>
                            <option value="novena_end_month">Neuvaine (9 derniers jours du mois)</option>
                        </select>
                    </div>

                    <!-- Frequency Details -->
                    <div id="frequency-details" class="form-group hidden">
                        <!-- Times per week -->
                        <div id="freq-times-week" class="freq-option hidden">
                            <label>Combien de fois par semaine ?</label>
                            <input type="number" id="times-per-week" min="1" max="7" value="3">
                        </div>

                        <!-- Specific days -->
                        <div id="freq-specific-days" class="freq-option hidden">
                            <label>Quels jours ?</label>
                            <div class="day-selector">
                                <button type="button" class="day-btn" data-day="0">D</button>
                                <button type="button" class="day-btn" data-day="1">L</button>
                                <button type="button" class="day-btn" data-day="2">M</button>
                                <button type="button" class="day-btn" data-day="3">M</button>
                                <button type="button" class="day-btn" data-day="4">J</button>
                                <button type="button" class="day-btn" data-day="5">V</button>
                                <button type="button" class="day-btn" data-day="6">S</button>
                            </div>
                        </div>

                        <!-- Every X days -->
                        <div id="freq-every-x-days" class="freq-option hidden">
                            <label>Tous les combien de jours ?</label>
                            <input type="number" id="every-x-days" min="2" max="30" value="2">
                        </div>

                        <!-- Every X weeks -->
                        <div id="freq-every-x-weeks" class="freq-option hidden">
                            <label>Toutes les combien de semaines ?</label>
                            <input type="number" id="every-x-weeks" min="1" max="12" value="2">
                        </div>

                        <!-- Every X months -->
                        <div id="freq-every-x-months" class="freq-option hidden">
                            <label>Tous les combien de mois ?</label>
                            <input type="number" id="every-x-months" min="1" max="12" value="2">
                        </div>
                    </div>

                    <!-- Options (au choix) -->
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="has-options">
                            <span>Cette habitude a des options au choix</span>
                        </label>
                    </div>

                    <div id="options-container" class="form-group hidden">
                        <label>Options disponibles</label>
                        <div id="options-list" class="options-list">
                            <!-- Generated dynamically -->
                        </div>
                        <button type="button" id="add-option-btn" class="btn-secondary btn-small">
                            + Ajouter une option
                        </button>
                    </div>

                    <!-- Submit -->
                    <button type="submit" class="btn-primary btn-large">
                        CrÃ©er l'habitude âœ¨
                    </button>
                </form>
            </section>
        </main>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <button class="nav-btn active" data-tab="today">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
                <span>Aujourd'hui</span>
            </button>
            <button class="nav-btn" data-tab="upcoming">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                    <path d="M8 14h.01"></path>
                    <path d="M12 14h.01"></path>
                    <path d="M16 14h.01"></path>
                    <path d="M8 18h.01"></path>
                </svg>
                <span>Prochaines</span>
            </button>
            <button class="nav-btn" data-tab="habits">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="8" y1="6" x2="21" y2="6"></line>
                    <line x1="8" y1="12" x2="21" y2="12"></line>
                    <line x1="8" y1="18" x2="21" y2="18"></line>
                    <line x1="3" y1="6" x2="3.01" y2="6"></line>
                    <line x1="3" y1="12" x2="3.01" y2="12"></line>
                    <line x1="3" y1="18" x2="3.01" y2="18"></line>
                </svg>
                <span>Habitudes</span>
            </button>
            <button class="nav-btn" data-tab="stats">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="20" x2="18" y2="10"></line>
                    <line x1="12" y1="20" x2="12" y2="4"></line>
                    <line x1="6" y1="20" x2="6" y2="14"></line>
                </svg>
                <span>Stats</span>
            </button>
            <button class="nav-btn" data-tab="add">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="8" x2="12" y2="16"></line>
                    <line x1="8" y1="12" x2="16" y2="12"></line>
                </svg>
                <span>Ajouter</span>
            </button>
        </nav>
    </div>

    <!-- Option Selection Modal -->
    <div id="option-modal" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <div class="modal-header">
                <span id="modal-habit-emoji" class="modal-emoji">ğŸ“š</span>
                <h3 id="modal-habit-name">Nom de l'habitude</h3>
            </div>
            <p class="modal-subtitle">Quelle option as-tu choisie ?</p>

            <div id="modal-options" class="modal-options">
                <!-- Generated by JS -->
            </div>

            <div class="modal-new-option hidden" id="new-option-container">
                <input type="text" id="new-option-input" placeholder="Nouvelle option...">
            </div>

            <div class="modal-actions">
                <button id="modal-cancel" class="btn-secondary">Annuler</button>
                <button id="modal-confirm" class="btn-primary">Valider âœ“</button>
            </div>
        </div>
    </div>

    <!-- Edit Habit Modal -->
    <div id="edit-modal" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>Modifier l'habitude</h3>
                <button id="edit-close" class="modal-close">Ã—</button>
            </div>

            <form id="edit-habit-form">
                <input type="hidden" id="edit-habit-id">

                <div class="form-group">
                    <label>Nom</label>
                    <input type="text" id="edit-habit-name" required>
                </div>

                <div class="form-group">
                    <label>Emoji</label>
                    <input type="text" id="edit-habit-emoji" maxlength="2">
                </div>

                <div class="form-group">
                    <label>CatÃ©gorie</label>
                    <select id="edit-habit-category">
                        <option value="learning">ğŸ“š Apprentissage</option>
                        <option value="spiritual">ğŸ™ Spirituel</option>
                        <option value="health">ğŸ’ª SantÃ©</option>
                        <option value="chores">ğŸ§¹ TÃ¢ches mÃ©nagÃ¨res</option>
                        <option value="work">ğŸ’¼ Travail</option>
                        <option value="projects">ğŸš€ Projets</option>
                        <option value="leisure">ğŸ® Loisirs</option>
                    </select>
                </div>

                <div class="modal-actions">
                    <button type="button" id="delete-habit-btn" class="btn-danger">Supprimer</button>
                    <button type="submit" class="btn-primary">Enregistrer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Habit Details Modal -->
    <div id="details-modal" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content modal-fullscreen">
            <div class="details-header">
                <button id="details-close" class="modal-back">
                    <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="15 18 9 12 15 6"></polyline>
                    </svg>
                </button>
                <div class="details-title">
                    <span id="details-emoji" class="details-emoji">ğŸ“š</span>
                    <h2 id="details-name">Nom de l'habitude</h2>
                </div>
                <span id="details-category" class="details-category-badge">CatÃ©gorie</span>
            </div>

            <div class="details-body">
                <!-- Description -->
                <div class="details-section">
                    <h3>ğŸ“ Description</h3>
                    <p id="details-description" class="details-description">Description complÃ¨te de l'habitude...</p>
                </div>

                <!-- Stats Grid -->
                <div class="details-stats-grid">
                    <div class="details-stat">
                        <span class="details-stat-icon">ğŸ”¥</span>
                        <span id="details-current-streak" class="details-stat-value">0</span>
                        <span class="details-stat-label">Streak actuel</span>
                    </div>
                    <div class="details-stat">
                        <span class="details-stat-icon">ğŸ†</span>
                        <span id="details-best-streak" class="details-stat-value">0</span>
                        <span class="details-stat-label">Meilleur</span>
                    </div>
                    <div class="details-stat">
                        <span class="details-stat-icon">âœ“</span>
                        <span id="details-total" class="details-stat-value">0</span>
                        <span class="details-stat-label">Total</span>
                    </div>
                    <div class="details-stat">
                        <span class="details-stat-icon">ğŸ“Š</span>
                        <span id="details-rate" class="details-stat-value">0%</span>
                        <span class="details-stat-label">Ce mois</span>
                    </div>
                </div>

                <!-- Mini Calendar (Last 30 days) -->
                <div class="details-section">
                    <h3>ğŸ“… Derniers 30 jours</h3>
                    <div id="details-mini-calendar" class="mini-calendar">
                        <!-- Generated by JS -->
                    </div>
                    <div class="mini-calendar-legend">
                        <span class="legend-item"><span class="legend-dot completed"></span> Fait</span>
                        <span class="legend-item"><span class="legend-dot missed"></span> ManquÃ©</span>
                        <span class="legend-item"><span class="legend-dot not-due"></span> Pas prÃ©vu</span>
                    </div>
                </div>

                <!-- Recent Completions -->
                <div class="details-section">
                    <h3>ğŸ• Historique rÃ©cent</h3>
                    <div id="details-history" class="completion-timeline">
                        <!-- Generated by JS -->
                    </div>
                </div>

                <!-- Frequency Info -->
                <div class="details-section">
                    <h3>â±ï¸ FrÃ©quence</h3>
                    <p id="details-frequency" class="details-frequency">Tous les jours</p>
                </div>

                <!-- Options if any -->
                <div id="details-options-section" class="details-section hidden">
                    <h3>ğŸ¯ Options disponibles</h3>
                    <div id="details-options" class="details-options-list">
                        <!-- Generated by JS -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Scripts -->
    <script src="script.js"></script>
    <script src="seeder.js"></script>
</body>

</html>